downloads:
  - github: Wohnzimmer-FM/lernos-common
    to: external
  - github: Wohnzimmer-FM/lernos-media
    to: external

chapters:
  - metadata/metadata-de.yaml
  - guide/katas.md
  - guide/kata1.md
  - guide/kata2.md
  - guide/kata3.md

build:
  vars:
    base: lernos-podcasting-guide-de
    language: de-de
    metadata: "--epub-metadata=metadata/metadata-de.yaml"
    textemp: "--template=external/lernos-common/templates/eisvogel.tex"

  jobs:
    - name: Clean up
      command: rm -r $output && mkdir $output
    
    - name: Create PDF
      command: pandoc $files -o $output/$base.pdf --from markdown $textemp --number-sections -V lang=$language $metadata

#    - name: Create HTML
#      command: pandoc $files -o $output/index.html --from markdown --number-sections -V lang=$language $metadata
    
    - name: Extract cover
      command: convert -density 300 $output/$base.pdf[0] $output/ebook-cover.png
      
    - name: Convert EPUB
      command: pandoc -s -o $output/$base.epub --epub-cover-image=$output/ebook-cover.png $metadata $files
      
#    - name: Convert MOBI
#      command: ebook-convert $output/$base.epub $output/$base.mobi

    - name: Convert DOCX
      command: pandoc $files -o $output/$base.docx --from markdown --number-sections -V lang=$language

#    - name: Copy images for Webseite
#      command: mkdir -p $output/guide/images && cp guide/images/*.png $output/guide/images